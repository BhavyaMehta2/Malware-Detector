package com.app.opcodeextractor.decoder;

import android.content.Context;
import android.util.Log;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.HashMap;

public class OPcode {
    static HashMap<String, String> dalvikOpCodes = new HashMap<>();
    static HashMap<String, String> reverseDalvikOpCodes = new HashMap<>();

    public OPcode(Context context1)
    {
        try {
            InputStream inputStream = context1.getAssets().open("DALVIK_OP_CODES_FILE.txt");
            BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream));
            String line;
            while ((line = reader.readLine()) != null) {
                String[] parts = line.split(" ");
                dalvikOpCodes.put(parts[0], parts[1]);
                reverseDalvikOpCodes.put(parts[1], parts[0]);
            }
            reader.close();
        } catch (IOException e) {
            Log.e("DALVIK_OPCODE", "Exception occurred while reading dalvik opcodes file: " + e.getMessage());
        }
    }

    public HashMap<String,String> getDalvikOpCodes()
    {
        return dalvikOpCodes;
    }

    public HashMap<String,String> getReverseDalvikOpCodes()
    {
        return reverseDalvikOpCodes;
    }
}
